<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />

    <title>สมัครสมาชิก</title>
    <style>
        body {
            background-color: #FFFFD4;
        }

        ul {
            list-style-type: none;
        }
    </style>
</head>

<body>

    <div class="row justify-content-center" style="margin-top: 5%;">
        <div class="card" style="width: 60rem; border-radius:10px">
            <div class="text-center">
                <h2>วิธีการสร้าง Line Token</h2>
            </div>
            <div>
                <ul>
                    <li>1. เข้าไปที่ลิงค์ <a href="https://notify-bot.line.me/th">Line Notify</a></li>
                    <li>2. ทำการเข้าสู่ระบบ</li>
                    <li>3. ทำการเลือกที่ "หน้าของฉัน" ตามรูปภาพด้านล่าง
                        <img src="./img/guide-line1.png" class="w-75 row" style="margin: 1%;">
                    </li>
                    <li>4. เลื่อนมาด้านล่าง และเลือกไปที่ "ออก Token" ตามรูปภาพด้านล่าง
                        <img src="./img/tokenline.png" class="w-75 row" style="margin: 1%;">
                    </li>
                    <li>5. ตั้งชื่อการแจ้งเตือน "ตรงโปรดใส่ชื่อ Token ตัวอย่าง แจ้งเตือนกิจกรรม"
                        <br>แล้วเลือกกด "รับการแจ้งเตือนแบบตัวต่อตัว จาก Line Notify" ให้กลายเป็นตัวสีเขียว 
                        <br>และกดเลือกที่ "ออก Token" ตามรูปภาพด้านล่าง
                        <img src="./img/guide-line2.png" class="w-75 row" style="margin: 1%;">
                        <img src="./img/guide-line3.png" class="w-75 row" style="margin: 1%;">
                    </li>
                    <li>6. กดเลือกที่ "คัดลอก" แล้วกลับมาว่าไว้ที่ช่อง "Line Token" ที่หน้าสมัครสมาชิกของ Assump Chana
                        <img src="./img/guide-line4.png" class="w-75 row" style="margin: 1%;">
                    </li>
                </ul>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
            crossorigin="anonymous"></script>
        <!-- <script src="/index.js"></script> -->
</body>

<script type="module">
    // Import the functions you need from the SDKs you need
    import { getAuth, createUserWithEmailAndPassword } from "https://cdnjs.cloudflare.com/ajax/libs/firebase/9.10.0/firebase-auth.min.js";
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-analytics.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
        apiKey: "AIzaSyBizgZbCCAYS7qzFkDwX6qrbgj3yFkGQHY",
        authDomain: "assump-chana.firebaseapp.com",
        projectId: "assump-chana",
        storageBucket: "assump-chana.appspot.com",
        messagingSenderId: "593385574351",
        appId: "1:593385574351:web:454331c8d1ca255912ccba",
        measurementId: "G-GN25FCXHZ7"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);

    document.getElementById("registerbtn").addEventListener("click", function () {
        const email = document.getElementById('email').value
        const nickname = document.getElementById('nickame').value
        const name = document.getElementById('fullname').value
        const token = document.getElementById('linetoken').value
        const address = [
            document.getElementById('house').value,
            document.getElementById('soi').value,
            document.getElementById('road').value,
            document.getElementById('subdistrict').value,
            document.getElementById('district').value,
            document.getElementById('provice').value,
            document.getElementById('post').value
        ]
        //const username = document.getElementById('uname').value;
        const password = document.getElementById('pwd').value;
        if (email == '' && password == '') {
            alert('Please enter information');
        } else {
            createUserWithEmailAndPassword(auth, email, password).then((data) => {
                axios({
                    methos: 'post',
                    url: 'localhost:8080/api/v1/accounts/create',
                    data: {
                        uid: data.user.uid,
                        email: data.user.email,
                        nickname: nickname,
                        name: name,
                        address: address,
                        lineToken: token
                    }
                }).catch(Error => {
                    console.error(Error)
                })
                alert('data submited');
                window.location.href = "login.html"
            })
                .catch((error) => {
                    // The write failed...
                    alert(error);
                });
        }
    });
</script>

</html>